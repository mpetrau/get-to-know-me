<div class="container">
  <div class="row">
    <div class="col-md-6 col-md-offset-3">
      <h1>Please select the traits that are applicable to you:</h1>
      <hr>
      <%= simple_form_for @user_trait do |f| %>
        <%= collection_check_boxes(:user, :traits, @traits, :id, :name) do |b| %>
          <%= b.label(class: "btn btn-lg") {b.check_box(class: "hidden") + b.text} %>
        <% end %>
        <br>
        <%= f.submit "Next", class: "btn btn-success", id: "send-traits" %>
      <% end %>
    </div>
  </div>
</div>

        <!-- alert("you have to select at least 2"); -->
<!-- do |b| b.label(class: "btn btn-primary") end -->
<!-- error: 'Please select at least 2 traits', input_html: { class: 'btn btn-primary' }  -->
<%= content_for(:after_js) do %>
  <%= javascript_tag do %>

  $(document).ready(function() {
    $("#send-traits").click(function(e) {
      e.preventDefault();
      if (validateLength()) { $("#new_user_trait").submit(); }
    });

    function validateLength()
    {
      var selected = $("#new_user_trait input[type=checkbox]:checked").length;
      if (selected < 2 ) {
        $.ajax("<% flash[:alert] = "There is a mistake submitting your form" %>");
        alert("you have to select at least 2");
      } else {
        return true
      }
    }

    $(".btn").click(function(e){
        e.preventDefault();
        $(this).toggleClass("btn-primary");
        var checkbox = $(this).find(':checkbox');
        checkbox.attr('checked', !checkbox.attr('checked'));
    });
  });

      <% end %>
<% end %>
